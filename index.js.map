{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst {\n  refresh: {\n    level: {\n      CACHE,\n    },\n    webgl: {\n      drawTextureCache,\n    },\n  },\n  math: {\n    matrix: {\n      calRectPoint,\n    },\n  },\n  util: {\n    isNil,\n  },\n  mode: {\n    CANVAS,\n    WEBGL,\n  },\n  inject,\n} = karas;\n\nfunction convertCoords2Gl(x, y, z, w, cx, cy, tz) {\n  if(w && w !== 1) {\n    x /= w;\n    y /= w;\n    z /= w;\n  }\n  if(x === cx) {\n    x = 0;\n  }\n  else {\n    x = (x - cx) / cx;\n  }\n  if(y === cy) {\n    y = 0;\n  }\n  else {\n    y = (cy - y) / cy;\n  }\n  if(tz) {\n    z /= -tz;\n  }\n  if(w === 1) {\n    return { x, y, z, w };\n  }\n  return { x: x * w, y: y * w, z: z * w, w };\n}\n\nclass $ extends karas.Geom {\n  constructor(tagName, props) {\n    super(tagName, props);\n    this.fill = props.fill;\n    this.list = props.list;\n  }\n  render(renderMode, ctx, dx, dy) {\n    let res = super.render(renderMode, ctx, dx, dy);\n    if(res.break) {\n      return res;\n    }\n    let root = this.__root;\n    if(renderMode !== root.__renderMode) {\n      return res;\n    }\n    let index = this.index, tx = this.tx, ty = this.ty, fill = this.fill, list = this.list;\n    // 第一次需要查看fill，渲染第一帧\n    if(index === undefined) {\n      if(fill === 'both' || fill === 'backwards') {\n        for(let i = 0, len = list.length; i < len; i++) {\n          let item = list[i];\n          // 防止空的\n          if(item.number) {\n            index = i;\n            tx = 0;\n            ty = 0;\n            break;\n          }\n        }\n      }\n      else {\n        return;\n      }\n    }\n    this.lastIndex = index;\n    let item = list[index];\n    if(!item.loading) {\n      item.loading = true;\n      inject.measureImg(item.url, res => {\n        if(res.success) {\n          item.cache = res;\n          if(index === this.lastIndex && !this.isDestroyed) {\n            this.render(renderMode, ctx, dx, dy);\n          }\n        }\n      });\n    }\n    let cache = item.cache;\n    if(cache) {\n      this.lastTx = tx;\n      this.lastTy = ty;\n      let w = cache.width / item.column, h = cache.height / item.row;\n      let sx = tx * w, sy = ty * h;\n      if(renderMode === CANVAS) {\n        ctx.drawImage(item.cache.source, sx, sy, w, h, this.x, this.y, this.width, this.height);\n        this.host.emit('frame');\n      }\n      else if(renderMode === WEBGL) {\n        let gl = ctx;\n        let env = this.env;\n        let cx = env.width * 0.5, cy = env.height * 0.5;\n        let texture = item.texture;\n        if(!texture) {\n          texture = item.texture = gl.createTexture();\n          gl.activeTexture(gl['TEXTURE0']);\n          gl.bindTexture(gl.TEXTURE_2D, texture);\n          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);\n          gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, cache.source);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        }\n        else {\n          gl.activeTexture(gl['TEXTURE0']);\n          gl.bindTexture(gl.TEXTURE_2D, texture);\n        }\n        if(texture) {\n          gl.useProgram(gl.program);\n          let m = this.matrixEvent, opacity = this.opacity;\n          let { x1, y1, z1, w1, x2, y2, z2, w2, x3, y3, z3, w3, x4, y4, z4, w4 }\n            = calRectPoint(this.x + dx, this.y + this.height + dy,\n            this.x + this.width + dx, this.y + dy, m);\n          let z = Math.max(Math.abs(z1), Math.abs(z2));\n          z = Math.max(z, Math.abs(z3));\n          z = Math.max(z, Math.abs(z4));\n          if(z) {\n            z = Math.max(z, Math.sqrt(cx * cx + cy * cy));\n          }\n          let t = convertCoords2Gl(x1, y1, z1, w1, cx, cy, z);\n          x1 = t.x; y1 = t.y; z1 = t.z;\n          t = convertCoords2Gl(x2, y2, z2, w2, cx, cy, z);\n          x2 = t.x; y2 = t.y; z2 = t.z;\n          t = convertCoords2Gl(x3, y3, z3, w3, cx, cy, z);\n          x3 = t.x; y3 = t.y; z3 = t.z;\n          t = convertCoords2Gl(x4, y4, z4, w4, cx, cy, z);\n          x4 = t.x; y4 = t.y; z4 = t.z;\n          let vtPoint = new Float32Array([\n            x1, y1, z1, w1,\n            x4, y4, z4, w4,\n            x2, y2, z2, w2,\n            x4, y4, z4, w4,\n            x2, y2, z2, w2,\n            x3, y3, z3, w3,\n          ]);\n          let tx1 = sx / cache.width, ty1 = (cache.height - sy - h) / cache.height;\n          let tx2 = (sx + w) / cache.width, ty2 = (cache.height - sy) / cache.height;\n          let vtTex = new Float32Array([\n            tx1, ty1, tx1, ty2, tx2, ty1,\n            tx1, ty2, tx2, ty1, tx2, ty2,\n          ]);\n          let vtOpacity = new Float32Array([\n            opacity, opacity, opacity, opacity, opacity, opacity,\n          ]);\n          // 顶点buffer\n          let pointBuffer = gl.createBuffer();\n          gl.bindBuffer(gl.ARRAY_BUFFER, pointBuffer);\n          gl.bufferData(gl.ARRAY_BUFFER, vtPoint, gl.STATIC_DRAW);\n          let a_position = gl.getAttribLocation(gl.program, 'a_position');\n          gl.vertexAttribPointer(a_position, 4, gl.FLOAT, false, 0, 0);\n          gl.enableVertexAttribArray(a_position);\n          // 纹理buffer\n          let texBuffer = gl.createBuffer();\n          gl.bindBuffer(gl.ARRAY_BUFFER, texBuffer);\n          gl.bufferData(gl.ARRAY_BUFFER, vtTex, gl.STATIC_DRAW);\n          let a_texCoords = gl.getAttribLocation(gl.program, 'a_texCoords');\n          gl.vertexAttribPointer(a_texCoords, 2, gl.FLOAT, false, 0, 0);\n          gl.enableVertexAttribArray(a_texCoords);\n          // opacity buffer\n          let opacityBuffer = gl.createBuffer();\n          gl.bindBuffer(gl.ARRAY_BUFFER, opacityBuffer);\n          gl.bufferData(gl.ARRAY_BUFFER, vtOpacity, gl.STATIC_DRAW);\n          let a_opacity = gl.getAttribLocation(gl.program, 'a_opacity');\n          gl.vertexAttribPointer(a_opacity, 1, gl.FLOAT, false, 0, 0);\n          gl.enableVertexAttribArray(a_opacity);\n          // 纹理单元\n          let u_texture = gl.getUniformLocation(gl.program, 'u_texture');\n          gl.uniform1i(u_texture, 0);\n          gl.drawArrays(gl.TRIANGLES, 0, 6);\n          gl.deleteBuffer(pointBuffer);\n          gl.deleteBuffer(texBuffer);\n          gl.deleteBuffer(opacityBuffer);\n          gl.disableVertexAttribArray(a_position);\n          gl.disableVertexAttribArray(a_texCoords);\n          gl.disableVertexAttribArray(a_opacity);\n          this.host.emit('frame');\n        }\n      }\n    }\n  }\n}\n\nclass FrameAnimate extends karas.Component {\n  constructor(props) {\n    super(props);\n    let {\n      duration = 1000,\n      direction,\n      delay = 0,\n      playbackRate = 1,\n      iterations = Infinity,\n      fill = 'both',\n    } = this.props;\n    this.duration = duration;\n    this.direction = direction;\n    this.playbackRate = playbackRate;\n    this.iterations = iterations;\n    this.delay = delay;\n    this.fill = fill;\n    this.__timeCount = 0;\n    let { list = [] } = this.props;\n    if(list.length) {\n      let count = 0, total = 0;\n      list.forEach((item, i) => {\n        let { row = 1, column = 1, number = row * column } = item;\n        item.row = row;\n        item.column = column;\n        item.number = number;\n        total += number;\n        item.index = i;\n      });\n      // 计算每个所占时长\n      let per = this.duration / total;\n      list.forEach(item => {\n        item.begin = count;\n        item.end = count += per * item.number;\n      });\n      // 反向也需要\n      count = 0;\n      list.reverse().forEach(item => {\n        item.begin2 = count;\n        item.end2 = count += per * item.number;\n      });\n      list.reverse();\n    }\n    this.list = list;\n  }\n\n  componentDidMount() {\n    let { list = [], autoPlay = true } = this.props;\n    if(list.length) {\n      let fake = this.ref.fake, root = this.root;\n      let cb = this.cb = diff => {\n        let currentTime = this.__timeCount += diff * this.playbackRate;\n        currentTime -= this.delay;\n        if(currentTime < 0) {\n          return;\n        }\n        let playCount = Math.floor(currentTime / this.duration);\n        if(playCount >= this.iterations) {\n          this.pause();\n          let fill = this.fill;\n          if(fill !== 'both' && fill !== 'forwards') {\n            fake.index = undefined;\n            root.__addUpdate(fake, [], CACHE, false, false, null, null);\n            return;\n          }\n        }\n        currentTime -= playCount * this.duration;\n        let alternate = false;\n        if(this.direction === 'alternate') {\n          alternate = playCount % 2 === 1;\n        }\n        if(alternate) {\n          for(let i = 0; i < list.length; i++) {\n            let item = list[i];\n            if(currentTime >= item.begin2 && currentTime < item.end2) {\n              let percent = (currentTime - item.begin2) / (item.end2 - item.begin2);\n              let per = 1 / item.number;\n              let n = Math.floor(percent / per);\n              if(n > item.number) {\n                n = item.number - 1;\n              }\n              let x = n % item.column;\n              let y = Math.floor(n / item.column);\n              x = item.column - x - 1;\n              y = item.row - y - 1;\n              fake.index = i;\n              fake.tx = x;\n              fake.ty = y;\n              root.__addUpdate(fake, [], CACHE, false, false, null, null);\n              break;\n            }\n          }\n        }\n        else {\n          for(let i = 0; i < list.length; i++) {\n            let item = list[i];\n            if(currentTime >= item.begin && currentTime < item.end) {\n              let percent = (currentTime - item.begin) / (item.end - item.begin);\n              let per = 1 / item.number;\n              let n = Math.floor(percent / per);\n              if(n > item.number) {\n                n = item.number - 1;\n              }\n              let x = n % item.column;\n              let y = Math.floor(n / item.column);\n              fake.index = i;\n              fake.tx = x;\n              fake.ty = y;\n              root.__addUpdate(fake, [], CACHE, false, false, null, null);\n              break;\n            }\n          }\n        }\n      };\n      if(autoPlay) {\n        fake.frameAnimate(cb);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    let { list = [] } = this.props;\n    let root = this.__root, renderMode = root.__renderMode;\n    if(renderMode === WEBGL) {\n      list.forEach(item => {\n        if(item.texture) {\n          root.ctx.deleteTexture(item.texture);\n        }\n      });\n    }\n  }\n\n  render() {\n    return <div>\n      <$ ref=\"fake\" style={{\n        width: '100%',\n        height: '100%',\n        fill: 'none',\n        stroke: 0,\n      }} fill={this.fill} list={this.list} direction={this.direction}\n         delay={this.delay} duration={this.duration} iterations={this.iterations}/>\n    </div>;\n  }\n\n  play() {\n    this.__timeCount = 0;\n    this.pause();\n    this.resume();\n  }\n\n  pause() {\n    this.ref.fake.removeFrameAnimate(this.cb);\n  }\n\n  pauseTo(n = 0) {\n    this.__timeCount = n;\n    this.cb(0);\n  }\n\n  pauseToFrame(n = 0) {\n    let { list = [] } = this.props;\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let { row = 1, column = 1, number = row * column } = item;\n      if(n < number) {\n        this.__timeCount = item.begin + (item.end - item.begin) * n;\n        let x = n % column;\n        let y = Math.floor(n / column);\n        let fake = this.ref.fake;\n        if(fake.index !== i || fake.lastTx !== x || fake.lastTy !== y) {\n          fake.index = fake.lastIndex = i;\n          fake.tx = x;\n          fake.ty = y;\n          this.root.__addUpdate(fake, [], CACHE, false, false, null, null);\n        }\n        break;\n      }\n    }\n  }\n\n  stop() {\n    this.pause();\n    this.__timeCount = 0;\n    let fake = this.ref.fake;\n    fake.index = undefined;\n    this.root.__addUpdate(fake, [], CACHE, false, false, null, null);\n  }\n\n  resume() {\n    this.ref.fake.frameAnimate(this.cb);\n  }\n\n  get duration() {\n    return this.__duration;\n  }\n\n  set duration(v) {\n    v = parseFloat(v) || 1000;\n    if(v <= 0) {\n      v = 1;\n    }\n    this.__duration = v;\n  }\n\n  get playbackRate() {\n    return this.__playbackRate;\n  }\n\n  set playbackRate(v) {\n    v = parseFloat(v) || 1;\n    if(v <= 0) {\n      v = 1;\n    }\n    this.__playbackRate = v;\n  }\n\n  get direction() {\n    return this.__direction;\n  }\n\n  set direction(v) {\n    this.__direction = v;\n  }\n\n  get iterations() {\n    return this.__iterations;\n  }\n\n  set iterations(v) {\n    if(v !== Infinity) {\n      v = parseInt(v) || 1;\n    }\n    if(v <= 0) {\n      v = 1;\n    }\n    this.__iterations = v;\n  }\n\n  get delay() {\n    return this.__delay;\n  }\n\n  set delay(v) {\n    this.__delay = parseInt(v) || 0;\n  }\n\n  get fill() {\n    return this.__fill;\n  }\n\n  set fill(v) {\n    this.__fill = v;\n  }\n\n  get list() {\n    return this.__list;\n  }\n\n  set list(v) {\n    this.__list = v;\n  }\n}\n\nFrameAnimate.version = version;\n\nexport default FrameAnimate;\n"],"names":["karas","refresh","CACHE","level","webgl","drawTextureCache","calRectPoint","math","matrix","util","isNil","mode","CANVAS","WEBGL","inject","convertCoords2Gl","x","y","z","w","cx","cy","tz","$","tagName","props","fill","list","renderMode","ctx","dx","dy","res","root","__root","__renderMode","index","tx","ty","undefined","i","len","length","item","number","lastIndex","loading","measureImg","url","success","cache","isDestroyed","render","lastTx","lastTy","width","column","h","height","row","sx","sy","drawImage","source","host","emit","gl","env","texture","createTexture","activeTexture","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","useProgram","program","m","matrixEvent","opacity","x1","y1","z1","w1","x2","y2","z2","w2","x3","y3","z3","w3","x4","y4","z4","w4","Math","max","abs","sqrt","t","vtPoint","Float32Array","tx1","ty1","tx2","ty2","vtTex","vtOpacity","pointBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","a_position","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","texBuffer","a_texCoords","opacityBuffer","a_opacity","u_texture","getUniformLocation","uniform1i","drawArrays","TRIANGLES","deleteBuffer","disableVertexAttribArray","Geom","FrameAnimate","duration","direction","delay","playbackRate","iterations","Infinity","__timeCount","count","total","forEach","per","begin","end","reverse","begin2","end2","autoPlay","fake","ref","cb","diff","currentTime","playCount","floor","pause","__addUpdate","alternate","percent","n","frameAnimate","deleteTexture","stroke","resume","removeFrameAnimate","__duration","v","parseFloat","__playbackRate","__direction","__iterations","parseInt","__delay","__fill","__list","Component","version"],"mappings":"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"}